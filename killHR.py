# -*- coding: UTF-8 -*-
import pyautogui
import base64
import os
import sys
from io import BytesIO
from time import sleep
from PIL import Image


# --------------Imagebase64--------------
b64_AV_logo = {
    "hr": b'iVBORw0KGgoAAAANSUhEUgAAABoAAAAeCAYAAAAy2w7YAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAAPaSURBVEhLlZZdbAxRFMf/dxaLVneban1si25F2qoQQUTrIz4iIsGLRLQPmoiIEh488iBCPEhIePdCPAjeCAkRiQcPSGp9p6iqj6atLW3T3bVznXPn3tlaMzvrl5y9H3Pn/OfcOXvniFQqJYUQkFKCW8uykM1m1Zj71nAnxPfLEIM3ICYIIGQBtz8AGUCO0n2Nrcg2H4CILwdj27ZqjU/jR4yNjSkhJfLjAUQfORy6RU5pNS0A+f6HOx91ZxzsP03iYxNgN+6CvbQVaNzgigl5f5bE1Enk1MujD3c9hLyQZL/JvpN7V8Cm2WKNidY6bSHY9USyKSxEYf23MfueAy3HnH4RWGpvvZ66kDETS4C1J4GyGmccAAl5OAqyzRf17cTB4t6XI+S1Pb5GG7+sQ99OCMrMECVTAP8fUYtHBOtO644/9O/0cOZnLW+dCPJZ1KY7/uiIKCOCbM072iJKAC9KZuiOPyTEjvKePN/WdfmLFAltHf16OTe2/n2wyCBFG0DhZNhIh2cxkQx1A0f69MAb/3e0/kXx25WkqDPDBf9TlszakJR54w2x3UC4Si8J4OsTpw2FgchcYMEOZ5yH99YtuaAvBzBCx/I3LTRtttPuvOm0eVhZu9TZKmNT5uhLAaSGgPMznb4IOa2BoxtHZvIs+tZVH8hFwlZH4yBY5GxUD4jFe3RHs3S/7jgkVxyliBr20peRo3GERFmjvuxD5mdOpKKevqK7/o2opll3iBQdj6vaYEUiEfSVtrtCkh35Qdfkdf0umPbHlDRlejAOKgsMn+uPgzWsUCgEsfI47F9UJPA7+nJXL8kjMwR5jd4Jr2E66LTwEmF66QGI3z+jCG86pOoRVZxwldLT04Pa+wspGWiydVQtdMmmIK/m3onYmgDK6/TIgzNhyB8ZfNzfherqano2myoGHWYsFsObZkrVETqTJFcUOeSViLu1Yjv9kQuJ8Dcrmcab9pfKp6qAuMLiDsOD2ngdXrU8g30pruYY+exETmTLQ/q/5K55YZ+K4/WeV4jH444A13S8dVxA8gI1IOMwu7u7EaPabuqyw5CX9NezdC7EzsKH569759A3b5vaLhZg3LounU5Tq6tJEjJV6sDAAEYHP6Hu0WqA8kS00aEZLlc3e/HuxVOUlM9EVVWV8mH8Gd9KlgdsHI2JrKKiApU1DUiseor08HRfEUomdHZ2YkbNfHWP8cGwT/Pwbta5E3oRt7yQ5/r7+5FMJtHU1OReZxKJBKLRKCorK9VTq+zSvgw8pwR563iCB4y5wQiZOVqH3t5eNc/GD8BZFQ6H/9oJxghyy0gp8QdFk5DY4EXJzgAAAABJRU5ErkJggg=='
}

# 火绒深色和浅色主题的按钮
b64_hr_buttons = {
    "dark": {
        "logout": b'iVBORw0KGgoAAAANSUhEUgAAAGsAAAAcCAYAAABmmEF1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAA/8SURBVGhD7ZoJVFVlu8d/ZwIckXkWFRCT6SCkgBNI4gCmKGCGmoBTXlOr1e121/e1vnVtXe1+q8xKTTEVTQM1c0yxwSFFnKiWoQdERUVLQCZTi+ncd5+zQYYDktp3b2v1X+ssznn23u9+9/t/n/8zbBSenp56/sKfAkr571/4E+Avsv5EUFlbW/9D/m4CChQKe+zt73L3rmz6l0KBWuNC+MQotH3tKNNd5clO40mMrxRj+DFsfD+6lN2n5KELpURjriXutemM9lJx5cebdB/6LIH3dVx9yKVtxyyFGNRFy8SYePydT7LlzZ3kyocMNzTzZ8KMgVjJlnahr6e2JJ+9O49SLJs6BhXmnUfwj+0LeereSf4Zt5jj8pEng8cfX6E2x/2Z/2LJi47kffzf/GN3nnykLaix6BLLO8deJyg/jZmvZzN0yZsMuXKYrw5sYv3RtleoXRlU1P2GU9gYxox+gdkTfGSrBCUqjSfh06YxdepUoqOj2/jEEBMzjWnTEpkS7WeCWAVKpRN+fr74+NjLtqaQPLsH3V2ccXbqhqVsbQqFUomTnx++Pj6YGqF9PHz89qFApXYmLDYULwcVlVduyfYOQrhJ/d1KLu4/T6dBzzNt1gKShrX9FG2TJXlDcQGZn2Ry1cydsBlzWwykgG5d6HTvHDvXrGGNyc9a1m3IorRbN7p1lS9rCoUKjdtQEufPY258yCMttkrjxtDE+cybG0/I7x/g8aDUoPGLZkI/C4pPfsaOcxXygQ5CrHFdSQGHtqxlxQeb0am6U1teLR9sDbX81yTq62rIP7KBVZl9+Z+oUBKTE7mkW0ajp0o3Kz9P1r59mHZ+yeXNGfn3SJxkSzMIqVXZ9MJn4EDsdLkGz/t9Mik8U2VDL5+BDLTTkdtyAIOU+zFuZG/y1jeV8d8BhRqN8xBiBpZw/HguxY3jS/HOmfCEsfQxz2fz2kNcU6px9hmMl6KAS3ZhjPUwFSTEBjULxkNsVLVDGBNm11Bu8FBz6qsVOIdMIskjm/U7W8+2XbIEXdTV5HNkw0oOeL6OVm2Dpinx0mLbezMsLg4/2dQcYmLmwR2La38AlBoztOPnkzLRloLyiyxsuQAKIYMONu3MTxBi5kqkUJVkQVavusUs2y2zJXmVfwxJA22FV6UKr6pEZe4uvHwOz1r9SFaZL88NcTOe2wyS9AqlEcKkt/YhZlpP2W5EQO/+3Dv506OQJVBfR03+IVKXq/GqLeJsU0+Xdq5NILHJnrKhJcTElGJi8q9/OerqqcrP5ydFkFHGyxY3D+ASWT26000ohL68jBLZ3ACF2gzXiKmkjO6L4y/FlF5p2KmyV8WPofe9bN6XvEqc6y7OjQvrS8+i71izZTMrfjD15MYNED5jCtqabLavP0qzSKcX633dtAY8nCyB+rpaLh3dzyX5dyOkuHbrHJkbW9ywEZJn+TNxURsy+AdDkvGCw5+Q6uHN0jkmZLwBItDr79yhSv5pgJA/M9cIpqaMwsPiFsfWpLJHjkkNJCYNcqBUd4BCehKgdWZISpSQxDx2fbiVI1lX5THCmTElgJrshkxPiVlnLc6TJuN7L5cD6elthJDWMEmWQtJev2GEelnLFr148BLyjh8lt+mDSmSVtXdDKWZVE/J/RJY077raYnJ2pZIRvJQ52miSE8+iW/awEsK4+yOmpjDKw4Jbx9aQuuccDaKiUKqw9h9EX0uRAboOZtpL/iJX6oGrdO6320mTiDKeiNpuANEJE7l3d29rr7a2xlZ8zZPup3ZkcJg1F46KuGg8oxVMk6VSYx+SQPL4Bj3VU/tbHtvOtyBL3ESpsqW/SJ3NZEtziDqmU3sxQUazYNsUcjAWu1Ft1o9xs2fjKh8xQpIjO55u7wZCVmqLc9iVmkHw0jloo5NJPKtjWSv3egClxhztpAWkRPXBXLebt1L30DTR0wuPLfp6JxuqJZmTypj+DEn0wPanYwZJlKlqA3r0+mJuVwiyPORyQYp/2vHMmeXDaURcbGNuJsnSizh148xpDnbSiXXU4DjkeSKdquguH2+ElHo7DGTySy7NJaQREpk9hEg8BNIONBFspesNwVj6qulJqKjrfA32B1CIHSoqA2ruywYT0AsZL87ZRWpGsJBDLdFCDs9KcnhbjG9rjZW4v9LGA2+R+ueXmeEWOZMXp0cISTsvJG0DmS1Scmm8kpwdpF0W20nTicCE5UTWVpN38IFUtg2JrHKq7sg/BZRqNX5R4/HuW8/lZhlcc5gmq8lk1OZdCO8jkSUfbIZ66n+7RsH5PEplS3NIKakD1r0ssWjuMkaIXV99/Ss+WnKtjSREjnmvRNGzOo8vVrRMvyXPcmF47BjcTd6gAUY5/H73Wr6JWsmz9l44C29UVqjwCdaKzExJXQ9fwkWhti/zF7zDowi0/Znj61Y8kLRmMC54eaUGi6CxPDe2DzZ5u3hrhySV0pycGTY+FGspZjl4YC1ks6v3MOLi/AxrW3bmIKVlImFXWmHjKEoDi+HED7Gj5uJmMpplcM3RRoIhT0Y8v9qibaYbYtbutHQKzXwZP60PxdlZHM1tSDekotWanMoIQnwDmPHaK5z84l0as1JJokpy2JeeIxtaQo55r4zEpeYaJ0Rs/EI+YoQYX9RZuVfP49i5gqL2GghSlnXrLJ++9za6ztc5dUu61pEBvsZdqFT3wDc8BLt9X3B5/2qWnqnlwldZ7Uia1HLTMmluIlobHbveSsPIq1EWRyYnEyDmpxTZcHchc/rAWKSkub76HqfKM1lXeF2oQld62GrwD09ioG0xJ1N3NJPblnjsrrter6eyspI7Pb0ZPm4iCc9PZ2K4H87mFVR27oxbxDOEeffD0zuAUQmRhA1oaDOIB1G7EDBiEhNjh2Gy2/RQCI+pL+PcpRv81sURT//2W06G7PBoBtsOCBKqNKh9xxLpVkdd6WnOFGqw8otldL9aCo7sY+v2zHYWTkpA3IicOZep4nlKLp3nu7sejIiLJ25SEjGhdzmwcSMbN21my9c6btfXcutcJhuFbdPmT/nqup7yqrvCs+xw8A0nQXimef6XrD3UfrR7Qq9I6qkpP8PWtYcpchjE9JS5vPTKG7zx8sv824znCfd35eb+bbz9zw/Y+f2DWkWltickIZkZ0ycw4FErZyk5sQ8hIXkG0ycM6GABbpSq8IQYPDtVo8tcTeqOs9yx7s+z8cMe3vaS7ukymNjngnES3ztZ+vHs/DnMSU4Sz/IMg+zOc0SoQPrWbXz2QymqumpR+qSRLmwZ2z4jq1AoV2kZlRobggS5Bq/6rH2vkvBkyBIJSW1BDnvTN/Hx9q/J+ukeDk9PJmHkCLS2RRz45H3Wpm0kY+sBsprMSKFUYGloojq1Tl46DOGhCktcnJ1xcurYKA11UrKIUTXFJ9m2NYfvv1nLoatm9BwissV2mqmN+K2KX26eIHvvPr798gQ//vg5n29MY9Mn69l5wviMUpPZoY8bXYT3X7vUhIl6UYRfLKRIakJ79OZe9qcP9SoJT4QsqS5z0UYSlzKTSQHOlBxZxfvLN3HgcrlBsz2fCiMy3OURGrVPHgoRP9y0k1iQMtrgVflfCpIKpXj2Hds/Osg1Gz9iZi5gQnu6bIh/J9j0/ipWrV0rNmIaaSJup6dnCM/JlGOXMSaGBLqK069ReNFw5QOYCRk2NBXyONiiNGgLj0ZWQ09NSt0dB5P8xuu8LGQgKTGOiABL7uTlcGTPBta+v5wtX92i35gpQhrns+jVJDqyaf8oGIgKjGfRi9MZIQrYn09sZKUhgzPGM6lp/dHBa9j4jiF5XnuvK0SsrLvN98d+4IfCQgrLK6houdiSVDqFMvypztRe+g7Z2QREYmIeQOz8SFHSCDlU3af0lnRQsgcS//prJE8wHXvbJ0uknirHYQz0kH/LUKhUOIYE0tNQH4nMZ1I4btU69n+4lHeXr+LgRanjUSoC9V42pK7ivXe2UFDrTVR8FH6PGpseC0IqNa6iHprNonmCqAF2/Kzbw3trtsheIMHYtD68biWbc6roGTaGabMXtrlwjRAbVylk3D8ggMj4BObM/ndeTRqGk0aDX/QE+lmUcGrHQTmrbEhMXmRqhCclVwpR9XAn0PBuR2SRak/CJ8fzXJg7pnLwNlJ3AalGcItk5oJkQp2ES9fYM0jc/HD5Ts7fruPXSzlcKOlD9/wTHDucRc6FC+Seu9rYkpEgFdelUiy7cpWi6zpCfaw4+jvfzz0uDK0z/wiGDh7NyHGDCLIXHnV8Hcu27G1V7Eqxt6bgEGmru8KcBSQGj2G6pTVeXqc59cVejucWG1tBwkPN/GNJGiRqKBtBlpUVvXr0wNLVDadONlSduMmWADfmGrK8zXI8Mqb6cbOmEhsvkvrjaazYDfPeTsQvdiw+ezZzWahVj3o91WUlzdaxAaZf60uT0cYxa+pEJg935+aBD9ivnsDCQWacPPEtZ06f4vTlUpwDg+lS1JokU5A6DZaWllSUlVFfLD20saG5KGMdU5zKOL8tnSOt6lpju2ncrCDsq6+JOmQv38lHGiE2lcYugimTeqPWreeFKSuMfUrJ6539iRgaxqhnIvDt54V9p2JO7NnF7s82tyaqCaR2m602mtER45gYHUxvS1HDncrmxysFXMzPJzv7JFe8/0bG4nG4Vpdy8fZF8vN0lIj68me9grt3u9MrdgLJfnq+XfIiC3fewMx1BLNmTCbmGUHUufUsW/0p31x0ZPKHH/JKQBUnUleyx2wSb7zgR+47Y5mX3np+JslSaDrRK+VjNs7uyy9iFy5+dzVnNOG8lDyFwQODsLmvQ1d0XdRX8gW/A/U1v6Lb8iYbchvIWk+im9DuO3do0oGRIbebuomvop5r95wuNdyXyco3ZHspTB8VhNa3H14OnSjO2ydIyuKIWPRzVx+2tQREzFHZaBk2JIJRL0QzqI8VVvpKyq6cZf0br/HpbVE3jvCi650qblTdEMpxjQoxbqXagl4Jy0l7NZCi3X9nyfJMcu9ZEDT7Pd5J6sMNsVk2yJvF0MoLTmHx0jkEqS9ScNeJ3laVbJ8fw9LT8jyawDRZKnMcByziby/8wu7V8sBKFTa9A/Dp742rpyP97exQik9f64bOfEcg6rFfb5Lxnwv5/KpUZ9kSMCqSvhIZjwrJs1yGEzvGHYu8Xbw8T5AlPMMhaByL/mM+QV1LhDeJ2ubsKbJFgOoATU0gJE5lQ+8hofj07EvouGDcczcYCGjLMSWvtNOOYXKIG2f3rjTERKWweQwdxWifOmHLFraGi6U1sCMwZjpx08fydPcabp3/hCVvbjI5fhv/3SSCnaon/ftXcK7lVVJAFRrtLjRa0b07ruLTcUg9ugpysx68bnhsGDzAX3i8I50rigQhxrGlBeo9OAqvzhVcyM6iI87UNoyk9Qrti+P1rCZJiWk0Sn6TFFGYhI3WWWPDhhg8CO8udVQUCTLb2Alt/yvaX/h/BvhfU5D3Ume3bwgAAAAASUVORK5CYII=',  # 火绒深色主题退出按钮base64
        "confirm": b'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'  # 火绒深色主题确认按钮base64
    },
    "light": {
        "logout": b'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',  # 火绒浅色主题退出按钮base64
        "confirm": b'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'  # 火绒浅色主题确认按钮base64
    }
}

# --------------AV Icon(用在生成托盘图标)--------------
icon_hr = b'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'


# 在内存中处理图像
def b64_to_image(b64_data):
    """将base64数据转换为内存中的图像对象"""
    return Image.open(BytesIO(base64.b64decode(b64_data)))


def detect_av():
    """检测目标杀毒软件"""
    tasklist = os.popen('wmic process get name').read().lower()
    if 'hipstray.exe' in tasklist:
        return 'hr'
    return None


def detect_theme(logout_img):
    """检测当前主题类型"""
    sleep(1.5)  # 增加等待时间确保界面完全加载

    # 尝试匹配浅色主题
    try:
        pos = pyautogui.locateOnScreen(logout_img, confidence=0.65)
        if pos:
            print("检测到浅色主题！！！")
            return "light"
    except:
        pass

    # 尝试匹配深色主题
    try:
        dark_logout_img = b64_to_image(b64_hr_buttons["dark"]["logout"])
        pos = pyautogui.locateOnScreen(dark_logout_img, confidence=0.65)
        if pos:
            print("检测到深色主题！！！")
            return "dark"
    except:
        pass

    print("无法检测主题，默认使用浅色主题")
    return "light"


def get_button_position(img_data, confidence=0.65, max_attempts=3):
    """获取按钮位置（带智能重试机制）"""
    button_img = b64_to_image(img_data)

    for attempt in range(max_attempts):
        try:
            # 限制搜索区域为屏幕右下角（托盘区域）
            screen_width, screen_height = pyautogui.size()
            search_region = (
                screen_width // 2,
                screen_height // 2,
                screen_width // 2,
                screen_height // 2
            )

            pos = pyautogui.locateOnScreen(
                button_img,
                confidence=confidence,
                region=search_region
            )

            if pos:
                center = pyautogui.center(pos)
                # 轻微随机偏移避免精确点击被拦截
                offset_x = random.randint(-3, 3)
                offset_y = random.randint(-3, 3)
                return (center.x + offset_x, center.y + offset_y)

        except Exception as e:
            print(f"定位按钮失败(尝试 {attempt + 1}/{max_attempts}): {str(e)}")

        # 重试前短暂等待并轻微移动鼠标
        sleep(0.5)
        pyautogui.moveRel(10, 10)  # 小幅度移动鼠标刷新界面

    print(f"无法定位按钮，已达到最大尝试次数 {max_attempts}")
    return None


def kill_av():
    """主退出逻辑"""
    AV = detect_av()
    if not AV:
        print("未检测到目标杀毒软件！！！")
        return False

    try:
        # 获取logo图像
        logo_img = b64_to_image(b64_AV_logo[AV])

        # 打开系统托盘（增加操作间隔）
        pyautogui.hotkey('win', 'b')
        sleep(0.8)
        pyautogui.press('enter')
        sleep(1.5)  # 增加延迟确保托盘完全展开

        # 定位并右键点击logo（带重试）
        logo_pos = None
        for attempt in range(3):
            try:
                logo_pos = get_button_position(b64_AV_logo[AV], confidence=0.65)
                if logo_pos:
                    pyautogui.rightClick(logo_pos)
                    # 立即将鼠标移动到屏幕中心位置，避免悬停弹出版本信息
                    screen_width, screen_height = pyautogui.size()
                    pyautogui.moveTo(screen_width // 2, screen_height // 2)
                    break
            except:
                sleep(0.5)
                # 失败时尝试重新打开托盘
                if attempt == 1:
                    pyautogui.hotkey('win', 'b')
                    sleep(0.5)
                    pyautogui.press('enter')
                    sleep(1.5)

        if not logo_pos:
            print("无法定位托盘图标")
            return False

        sleep(1.5)  # 等待菜单弹出

        # 检测当前主题
        light_logout_img = b64_to_image(b64_hr_buttons["light"]["logout"])
        theme = detect_theme(light_logout_img)

        # 获取退出按钮位置（带重试）
        logout_pos = get_button_position(b64_hr_buttons[theme]["logout"])
        if not logout_pos:
            print("无法定位退出按钮")
            return False

        pyautogui.click(logout_pos)
        sleep(1.5)  # 增加等待确保确认窗口弹出

        # 获取确认按钮位置（带重试）
        confirm_pos = get_button_position(b64_hr_buttons[theme]["confirm"])
        if not confirm_pos:
            print("无法定位确认按钮")
            return False

        pyautogui.click(confirm_pos)
        sleep(1)
        print("杀毒软件已成功退出！！！")
        return True

    except Exception as e:
        print(f"退出过程中出错: {str(e)}")
        return False


if __name__ == '__main__':
    import random

    kill_av()